import { useContext, useEffect, useState } from "react"
import {
    Box,
    Grid,
    Typography,
    Button,
    IconButton,
} from "@mui/material"
import { useLocation, useNavigate, useParams } from "react-router-dom"
import ChevronLeftIcon from "@mui/icons-material/ChevronLeft"
import Mobile from "../../components/layout/Mobile"
import { CARD365, V8 } from "../../data/GameImg"
import { GameContext } from "../../context/GameContext"

const GAME_DATA = {
    V8: V8,
    Card365: CARD365,
}

const GAME_LABELS = {
    V8: "V8Card",
    Card365: "Card365",
}

const PvcAllGames = () => {
    const [activeGame, setActiveGame] = useState(null)
    const navigate = useNavigate()
    const index = new URLSearchParams(useLocation().search).get("index")

    const { handleApiClick } = useContext(GameContext)

    const gameItems = GAME_DATA[activeGame] || []

    useEffect(() => {
        if (index === "0") {
            setActiveGame("V8")
        } else if (index === "1") {
            setActiveGame("Card365")
        }
    }, [index])

    return (
        <Mobile>
            {/* Header */}
            <Box
                sx={{
                    background: "#323738",
                    padding: "8px 10px",
                    display: "flex",
                    alignItems: "center",
                    color: "white",
                }}
            >
                <IconButton
                    sx={{
                        color: "#fff",
                        position: "absolute",
                        left: 28,
                    }}
                    onClick={() => navigate(-1)}
                >
                    <ChevronLeftIcon sx={{ fontSize: 30 }} />
                </IconButton>
                <Typography
                    variant="h6"
                    sx={{
                        flexGrow: 1,
                        display: "flex",
                        alignItems: "center",
                        justifyContent: "center",
                        color: "white",
                    }}
                >
                Game
                </Typography>
            </Box>

            {/* Filter Buttons */}
            <Grid container spacing={1} sx={{ padding: "10px", width: "100%" }}>
                {Object.keys(GAME_DATA).map((gameKey) => {
                    const color = activeGame === gameKey ? "#000000" : "#a7a5a1"

                    return (
                        <Grid item xs={6} key={gameKey}>
                            <Button
                                fullWidth
                                onClick={() => setActiveGame(gameKey)}
                                sx={{
                                    background: activeGame === gameKey ? "linear-gradient(90deg,#24ee89,#9fe871)" : "#323738",
                                    color: activeGame === gameKey ? "#202331" : "#a7a5a1",
                                    textTransform: "none",
                                    display: "flex",
                                    flexDirection: "column",
                                    alignItems: "center",
                                    justifyContent: "center",
                                }}
                            >
                                {gameKey === "V8" ?
                                    <svg
                                        width={50}
                                        height={25}
                                        color={activeGame === gameKey ? "#000000" : "#a7a5a1"}
                                        viewBox="0 0 100 50"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path d="M37.2572 7.25285L37.5 8L41.5557 21.3042H41.7223L45.9999 8L46.2026 7.25285H50.4999L49.9999 8L44.0891 25.7471H39.1976L33.2504 8L32.4999 7.25285H37.2572Z" fill={color}></path>
                                        <path d="M59.031 26C57.681 26 56.48 25.7742 55.4281 25.3227C54.382 24.8652 53.5609 24.2421 52.9648 23.4534C52.3687 22.6648 52.0707 21.7708 52.0707 20.7714C52.0707 20.0008 52.2402 19.2934 52.5791 18.6492C52.9239 17.999 53.3914 17.4602 53.9817 17.0328C54.5719 16.5993 55.2323 16.3224 55.9628 16.202V16.0756C55.0044 15.8769 54.2271 15.3983 53.631 14.6397C53.035 13.8752 52.7369 12.9872 52.7369 11.9758C52.7369 11.0185 53.0087 10.1667 53.5522 9.42015C54.0956 8.66762 54.8408 8.07763 55.7875 7.65019C56.7401 7.21673 57.8212 7 59.031 7C60.2407 7 61.3189 7.21673 62.2657 7.65019C63.2182 8.08365 63.9663 8.67665 64.5098 9.42918C65.0533 10.1757 65.328 11.0246 65.3338 11.9758C65.328 12.9932 65.0241 13.8812 64.4221 14.6397C63.8202 15.3983 63.0488 15.8769 62.1079 16.0756V16.202C62.8267 16.3224 63.4783 16.5993 64.0627 17.0328C64.653 17.4602 65.1205 17.999 65.4653 18.6492C65.8159 19.2934 65.9942 20.0008 66 20.7714C65.9942 21.7708 65.6932 22.6648 65.0971 23.4534C64.501 24.2421 63.677 24.8652 62.6251 25.3227C61.579 25.7742 60.3809 26 59.031 26ZM59.031 23.1283C59.6329 23.1283 60.1589 23.017 60.6089 22.7942C61.0589 22.5654 61.4095 22.2524 61.6608 21.855C61.9179 21.4517 62.0465 20.9881 62.0465 20.4644C62.0465 19.9285 61.915 19.456 61.652 19.0466C61.389 18.6312 61.0326 18.3061 60.5826 18.0713C60.1326 17.8305 59.6154 17.7101 59.031 17.7101C58.4524 17.7101 57.9352 17.8305 57.4794 18.0713C57.0235 18.3061 56.6641 18.6312 56.4011 19.0466C56.144 19.456 56.0154 19.9285 56.0154 20.4644C56.0154 20.9881 56.1411 21.4517 56.3924 21.855C56.6437 22.2524 56.9972 22.5654 57.4531 22.7942C57.9089 23.017 58.4349 23.1283 59.031 23.1283ZM59.031 14.8655C59.5336 14.8655 59.9806 14.7601 60.3722 14.5494C60.7637 14.3387 61.0705 14.0467 61.2926 13.6735C61.5147 13.3002 61.6257 12.8698 61.6257 12.3821C61.6257 11.9005 61.5147 11.4791 61.2926 11.1179C61.0705 10.7506 60.7667 10.4647 60.3809 10.26C59.9952 10.0493 59.5452 9.94392 59.031 9.94392C58.5225 9.94392 58.0725 10.0493 57.681 10.26C57.2894 10.4647 56.9826 10.7506 56.7605 11.1179C56.5443 11.4791 56.4362 11.9005 56.4362 12.3821C56.4362 12.8698 56.5472 13.3002 56.7693 13.6735C56.9914 14.0467 57.2982 14.3387 57.6898 14.5494C58.0813 14.7601 58.5284 14.8655 59.031 14.8655Z" fill={color}></path>                          <path d="M15 43.7871V28.2129H20.9905C22.1421 28.2129 23.1232 28.4385 23.9338 28.8897..." fill={color} />
                                        <path d="M15 43.7871V28.2129H20.9905C22.1421 28.2129 23.1232 28.4385 23.9338 28.8897C24.7444 29.3359 25.3623 29.9569 25.7873 30.7529C26.2173 31.5437 26.4323 32.4563 26.4323 33.4905C26.4323 34.5247 26.2149 35.4373 25.7799 36.2281C25.345 37.019 24.7148 37.635 23.8894 38.076C23.0689 38.5171 22.0754 38.7376 20.9089 38.7376H17.0907V36.0989H20.39C21.0078 36.0989 21.5169 35.9899 21.9172 35.7719C22.3225 35.5488 22.624 35.2421 22.8217 34.8517C23.0244 34.4563 23.1257 34.0025 23.1257 33.4905C23.1257 32.9734 23.0244 32.5222 22.8217 32.1369C22.624 31.7465 22.3225 31.4449 21.9172 31.2319C21.5119 31.0139 20.9979 30.9049 20.3751 30.9049H18.2103V43.7871H15Z" fill={color}></path>
                                        <path d="M42.4706 36C42.4706 37.6984 42.1568 39.1432 41.5291 40.3346C40.9063 41.526 40.0561 42.436 38.9786 43.0646C37.9061 43.6882 36.7001 44 35.3606 44C34.0113 44 32.8003 43.6857 31.7278 43.057C30.6552 42.4284 29.8076 41.5184 29.1848 40.327C28.562 39.1356 28.2506 37.6933 28.2506 36C28.2506 34.3016 28.562 32.8568 29.1848 31.6654C29.8076 30.474 30.6552 29.5665 31.7278 28.943C32.8003 28.3143 34.0113 28 35.3606 28C36.7001 28 37.9061 28.3143 38.9786 28.943C40.0561 29.5665 40.9063 30.474 41.5291 31.6654C42.1568 32.8568 42.4706 34.3016 42.4706 36ZM39.2159 36C39.2159 34.8999 39.0553 33.9721 38.734 33.2167C38.4177 32.4613 37.9703 31.8885 37.3921 31.4981C36.8138 31.1077 36.1366 30.9125 35.3606 30.9125C34.5846 30.9125 33.9075 31.1077 33.3292 31.4981C32.7509 31.8885 32.3011 32.4613 31.9799 33.2167C31.6635 33.9721 31.5054 34.8999 31.5054 36C31.5054 37.1001 31.6635 38.0279 31.9799 38.7833C32.3011 39.5387 32.7509 40.1115 33.3292 40.5019C33.9075 40.8923 34.5846 41.0875 35.3606 41.0875C36.1366 41.0875 36.8138 40.8923 37.3921 40.5019C37.9703 40.1115 38.4177 39.5387 38.734 38.7833C39.0553 38.0279 39.2159 37.1001 39.2159 36Z" fill="currentColor"></path>                          <path d="M72.0264 43.7871V28.2129H78.0169C79.1636 28.2129 80.1423 28.4233..." fill={color} />
                                        <path d="M44.8487 43.7871V28.2129H48.0589V35.0798H48.2591L53.7232 28.2129H57.571L51.9364 35.1863L57.6378 43.7871H53.7973L49.6381 37.384L48.0589 39.3612V43.7871H44.8487Z" fill={color}></path>
                                        <path d="M59.2429 43.7871V28.2129H69.4742V30.9278H62.4531V34.6388H68.9478V37.3536H62.4531V41.0722H69.5038V43.7871H59.2429Z" fill={color}></path>
                                        <path d="M72.0264 43.7871V28.2129H78.0169C79.1636 28.2129 80.1423 28.4233 80.9529 28.8441C81.7684 29.2598 82.3887 29.8504 82.8138 30.616C83.2438 31.3764 83.4588 32.2712 83.4588 33.3004C83.4588 34.3346 83.2413 35.2243 82.8064 35.9696C82.3714 36.7098 81.7412 37.2776 80.9158 37.673C80.0953 38.0684 79.1018 38.2662 77.9354 38.2662H73.9244V35.6198H77.4164C78.0293 35.6198 78.5384 35.5336 78.9437 35.3612C79.349 35.1888 79.6505 34.9303 79.8482 34.5856C80.0508 34.2408 80.1522 33.8124 80.1522 33.3004C80.1522 32.7833 80.0508 32.3473 79.8482 31.9924C79.6505 31.6375 79.3465 31.3688 78.9363 31.1863C78.531 30.9987 78.0194 30.9049 77.4016 30.9049H75.2367V43.7871H72.0264ZM80.2263 36.6996L84 43.7871H80.4561L76.764 36.6996H80.2263Z" fill={color}></path>
                                    </svg>
                                    : <svg
                                        width={50}
                                        height={25}
                                        color={activeGame === gameKey ? "#000000" : "#a7a5a1"}
                                        viewBox="0 0 100 50"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path d="M26.9014 14.223V10.4223C28.5813 10.2816 31.9412 10.4223 34.0412 12.1115C35.9534 13.6498 36.9811 15.4899 36.9811 19.7129C36.9811 23.5136 31.5212 25.2029 32.7812 25.2029C34.0412 25.2029 37.821 26.4698 37.821 30.6928C37.821 34.9158 36.6724 36.8378 35.3011 37.8719C33.6212 39.1388 29.2813 40.1242 27.3214 39.9834V36.605C28.5813 36.605 29.0013 35.4789 29.0013 34.9158V29.0036C29.0013 27.3144 29.0013 26.4698 27.7414 26.4698C26.7334 26.4698 26.0614 26.4698 25.6414 25.6252C25.3614 24.7806 25.2215 23.0914 26.9014 23.0914C28.5813 23.0914 29.0013 22.2468 29.0013 21.8245V15.0676C29.0013 14.392 27.6014 14.223 26.9014 14.223Z" fill="currentColor"></path>
                                        <path d="M51.2606 13.8007V10.4223C41.6009 11.6892 40.7609 21.8245 40.7609 22.2467C40.7609 22.669 39.921 30.2705 43.2808 35.3381C45.6676 38.9379 49.4406 39.9834 50.8406 39.9834V36.605C50.5606 36.605 49.9166 36.5205 49.5806 36.1827C49.2446 35.8448 49.1606 35.1973 49.1606 34.9158V15.4899C49.1606 14.1386 50.5606 13.8007 51.2606 13.8007Z" fill="currentColor"></path>
                                        <path d="M54.2005 22.669C51.5126 22.669 50.0006 23.5136 49.5806 23.9359V27.7367L51.2606 26.8921C51.9326 26.5542 52.5205 26.8921 52.5205 28.159V34.4935C52.5205 36.5205 51.6806 36.605 51.2606 36.605V39.9834C51.2606 39.9834 60.0803 39.5611 60.5003 30.2705C60.7291 25.2081 57.5604 22.669 54.2005 22.669Z" fill="currentColor"></path>
                                        <path d="M75.1998 11.6892C71.7733 11.6892 67.22 10.9854 65.1201 10.4223L64.7001 18.0237C64.7001 18.0237 73.5198 19.7129 77.2997 16.7568C79.6718 14.9017 81.0796 11.6892 81.4995 10C81.4995 10 78.5596 11.6892 75.1998 11.6892Z" fill="currentColor"></path>
                                        <path d="M67.64 19.713L64.7001 19.2906L64.2801 24.3582C64.2801 25.2028 64.2925 26.0599 64.7001 26.4698C65.5401 27.3144 66.8 26.8921 68.06 26.0475C69.068 25.3718 70.4399 24.9213 70.9999 24.7805V20.9798C70.9999 20.9798 67.92 22.106 67.22 22.669L67.64 19.713Z" fill="currentColor"></path>
                                        <path d="M71.4199 24.7805V20.9798C77.2997 20.5575 81.4523 23.8832 81.9195 28.5813C82.3395 32.8043 81.0796 36.1827 78.9796 37.8719C77.1245 39.3642 72.8781 40.1242 71.3382 39.9834V37.0273C71.3382 37.0273 73.9398 36.8865 73.9398 34.4935V26.8921C73.9398 25.2029 71.9799 24.7805 71.4199 24.7805Z" fill="currentColor"></path>
                                        <path d="M26.4813 14.223V10.4223C21.0215 10.8446 19.3416 14.6453 18.9216 16.7568C18.5016 18.8683 19.7616 22.2467 22.7015 22.2467C25.6414 22.2467 27.3213 20.1352 27.3213 18.0237C27.3213 15.9122 25.2214 15.0676 25.2214 14.6453C25.2214 14.3075 26.0613 14.223 26.4813 14.223Z" fill="currentColor"></path>
                                        <path d="M51.6805 13.8007V10.4223C57.1403 10.8446 59.2402 13.8007 59.6602 15.9122C60.1811 18.5313 58.8202 21.8244 55.8803 21.8244C52.9404 21.8244 51.6806 19.7129 51.6806 18.0237C51.6806 15.9122 53.3604 15.0676 53.3604 14.6453C53.3604 13.8844 52.1005 13.8007 51.6805 13.8007Z" fill="currentColor"></path>
                                        <path d="M26.9801 36.605V39.9834C21.5202 39.5611 18.5016 36.605 18.0814 34.0712C17.5929 31.1257 19.3416 28.159 22.2815 28.159C25.2214 28.159 26.4813 30.2705 26.4813 32.382C26.4813 34.4935 24.8014 35.7604 24.8014 36.1827C24.8014 36.5205 26.5601 36.605 26.9801 36.605Z" fill="currentColor"></path>
                                        <path d="M70.9998 37.0273L71.0003 39.9834C65.5405 39.5611 63.96 36.1602 63.4405 34.0712C62.8494 31.6944 64.2807 28.5813 66.8004 28.5813C69.7403 28.5813 71.0003 30.2705 71.0003 32.382C71.0003 34.4935 68.8999 35.3381 68.9004 36.1827C68.9006 36.5205 70.5798 37.0273 70.9998 37.0273Z" fill="currentColor"></path>
                                    </svg>}
                                <Typography sx={{
                                    fontWeight: activeGame === gameKey ? "bold" : "normal",
                                    fontSize: "14px",
                                }}>
                                    {GAME_LABELS[gameKey]}
                                </Typography>
                            </Button>
                        </Grid>
                    )
                })}
            </Grid>

            {/* Game Cards */}
            {gameItems.length > 0 && (
                <Grid container spacing={0} sx={{ px: 1}}>
                    {gameItems.map((item, index) => (
                        <Grid
                            item
                            xs={4}
                            key={item.id || index}
                            sx={{
                                border: "none",
                                position: "relative",
                                background: "transparent",
                            }}
                            onClick={() => handleApiClick(item.id, activeGame, "PVC")}
                        >
                            <img
                                src={item.imgSrc}
                                alt={item.game}
                                style={{
                                    width: "90%",
                                    borderRadius: "5px",
                                    aspectRatio: (activeGame === "V8" )? 1/1 : 3/4
                                }}
                            />
                        </Grid>
                    ))}
                </Grid>
            )}
        </Mobile>
    )
}

export default PvcAllGames